# ๐ ุฏููู ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช - NexBuy

ูุฐุง ุงูุฏููู ุณูุณุงุนุฏู ูู ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุงููุฉ ูุชุทุจูู NexBuy ูู Supabase.

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### ุงูุฎุทูุฉ 1: ูุชุญ ูุญุฑุฑ SQL ูู Supabase

1. ุงุฐูุจ ุฅูู ููุญุฉ ุชุญูู ูุดุฑูุน Supabase
2. ุงุถุบุท ุนูู **SQL Editor** ูู ุงูุดุฑูุท ุงูุฌุงูุจู
3. ุงุถุบุท ุนูู **New Query**

### ุงูุฎุทูุฉ 2: ุชุดุบูู Migration

1. ุงูุณุฎ ูุญุชูู ููู `supabase_migration.sql` ุจุงููุงูู
2. ุงูุตูู ูู ูุญุฑุฑ SQL
3. ุงุถุบุท ุนูู **Run** (ุฃู ุงุถุบุท `Ctrl+Enter`)

### ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู ุงูุฌุฏุงูู

1. ุงุฐูุจ ุฅูู **Table Editor** ูู ุงูุดุฑูุท ุงูุฌุงูุจู
2. ูุฌุจ ุฃู ุชุฑู ูุฐู ุงูุฌุฏุงูู:
   - โ `users` - ูุนูููุงุช ุงููุณุชุฎุฏููู
   - โ `addresses` - ุนูุงููู ุงูุดุญู
   - โ `categories` - ูุฆุงุช ุงูููุชุฌุงุช
   - โ `products` - ุงูููุชุฌุงุช
   - โ `orders` - ุงูุทูุจุงุช
   - โ `order_items` - ุนูุงุตุฑ ุงูุทูุจุงุช
   - โ `cart_items` - ุณูุฉ ุงูุชุณูู
   - โ `favorites` - ุงูููุถูุฉ

---

## ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 1. ุฌุฏูู **users**
ูุฎุฒู ูุนูููุงุช ุงููุณุชุฎุฏู ุงูุฅุถุงููุฉ (ุงูุงุณูุ ุงููุงุชูุ ุตูุฑุฉ ุงูููู ุงูุดุฎุตูุ ุญุงูุฉ ุงูุฃุฏูู)

**ุงูุฃุนูุฏุฉ:**
- `id` - ูุนุฑู ุงููุณุชุฎุฏู (ูุฑุจุท ุจู auth.users)
- `name` - ุงูุงุณู
- `phone` - ุฑูู ุงููุงุชู
- `profile_image` - ุฑุงุจุท ุตูุฑุฉ ุงูููู ุงูุดุฎุตู
- `is_admin` - ูู ุงููุณุชุฎุฏู ุฃุฏููุ (ุงูุชุฑุงุถู: false)
- `created_at` - ุชุงุฑูุฎ ุงูุฅูุดุงุก
- `updated_at` - ุชุงุฑูุฎ ุงูุชุญุฏูุซ

---

### 2. ุฌุฏูู **addresses**
ูุฎุฒู ุนูุงููู ุงูุดุญู ูููุณุชุฎุฏููู

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู ุงููุฑูุฏ
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `title` - ุงูุนููุงู (ูุซู: "ุงูููุฒู"ุ "ุงูุนูู")
- `full_address` - ุงูุนููุงู ุงููุงูู
- `latitude` - ุฎุท ุงูุนุฑุถ
- `longitude` - ุฎุท ุงูุทูู
- `city` - ุงููุฏููุฉ
- `state` - ุงููุญุงูุธุฉ
- `zip_code` - ุงูุฑูุฒ ุงูุจุฑูุฏู
- `country` - ุงูุฏููุฉ (ุงูุชุฑุงุถู: "Egypt")
- `is_default` - ูู ูู ุงูุนููุงู ุงูุงูุชุฑุงุถูุ
- `created_at` - ุชุงุฑูุฎ ุงูุฅูุดุงุก
- `updated_at` - ุชุงุฑูุฎ ุงูุชุญุฏูุซ

---

### 3. ุฌุฏูู **categories**
ูุฎุฒู ูุฆุงุช ุงูููุชุฌุงุช

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู (ูุซู: "smartphones", "laptops")
- `name_en` - ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ
- `name_ar` - ุงูุงุณู ุจุงูุนุฑุจูุฉ
- `image_url` - ุฑุงุจุท ุงูุตูุฑุฉ
- `description` - ุงููุตู

**ุงููุฆุงุช ุงูุงูุชุฑุงุถูุฉ:**
- Smartphones / ุงูููุงุชู ุงูุฐููุฉ
- Laptops / ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุงููุญูููุฉ
- Headphones / ุณูุงุนุงุช ุงูุฑุฃุณ
- Watches / ุงูุณุงุนุงุช
- Tablets / ุงูุฃุฌูุฒุฉ ุงูููุญูุฉ
- Accessories / ุงูุฅูุณุณูุงุฑุงุช

---

### 4. ุฌุฏูู **products**
ูุฎุฒู ูุนูููุงุช ุงูููุชุฌุงุช

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `name` - ุงูุงุณู
- `description` - ุงููุตู
- `price` - ุงูุณุนุฑ
- `rating` - ุงูุชูููู (ุงูุชุฑุงุถู: 4.5)
- `image_path` - ูุณุงุฑ ุงูุตูุฑุฉ
- `category` - ุงููุฆุฉ
- `is_favorite` - ูู ููุถูุ
- `features` - ุงููููุฒุงุช (JSONB)
- `brand` - ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ
- `model` - ุงูููุฏูู
- `specifications` - ุงูููุงุตูุงุช (JSONB)
- `stock_quantity` - ุงููููุฉ ุงููุชููุฑุฉ
- `created_at` - ุชุงุฑูุฎ ุงูุฅูุดุงุก
- `updated_at` - ุชุงุฑูุฎ ุงูุชุญุฏูุซ

---

### 5. ุฌุฏูู **orders**
ูุฎุฒู ุทูุจุงุช ุงููุณุชุฎุฏููู

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `order_number` - ุฑูู ุงูุทูุจ (ูุซู: "NEX-2024-001")
- `total_amount` - ุงููุจูุบ ุงูุฅุฌูุงูู
- `status` - ุงูุญุงูุฉ (pending, confirmed, processing, shipped, delivered, cancelled, returned)
- `shipping_address_id` - ูุนุฑู ุนููุงู ุงูุดุญู
- `order_date` - ุชุงุฑูุฎ ุงูุทูุจ
- `delivery_date` - ุชุงุฑูุฎ ุงูุชุณููู
- `tracking_number` - ุฑูู ุงูุชุชุจุน
- `payment_method` - ุทุฑููุฉ ุงูุฏูุน
- `payment_status` - ุญุงูุฉ ุงูุฏูุน

---

### 6. ุฌุฏูู **order_items**
ูุฎุฒู ุนูุงุตุฑ ูู ุทูุจ

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `order_id` - ูุนุฑู ุงูุทูุจ
- `product_id` - ูุนุฑู ุงูููุชุฌ
- `product_name` - ุงุณู ุงูููุชุฌ (ูุณุฎุฉ ูุญููุธุฉ)
- `product_image` - ุตูุฑุฉ ุงูููุชุฌ (ูุณุฎุฉ ูุญููุธุฉ)
- `price` - ุงูุณุนุฑ (ูุณุฎุฉ ูุญููุธุฉ)
- `quantity` - ุงููููุฉ

---

### 7. ุฌุฏูู **cart_items**
ูุฎุฒู ุนูุงุตุฑ ุณูุฉ ุงูุชุณูู

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `product_id` - ูุนุฑู ุงูููุชุฌ
- `quantity` - ุงููููุฉ

---

### 8. ุฌุฏูู **favorites**
ูุฎุฒู ุงูููุชุฌุงุช ุงูููุถูุฉ ูููุณุชุฎุฏููู

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `product_id` - ูุนุฑู ุงูููุชุฌ

---

## ๐ ุงูุฃูุงู (RLS Policies)

ุฌููุน ุงูุฌุฏุงูู ูุฏููุง **Row Level Security (RLS)** ููุนู ูุน ุงูุณูุงุณุงุช ุงูุชุงููุฉ:

- โ ุงููุณุชุฎุฏููู ูููููู ูุฑุงุกุฉ/ุชุญุฏูุซ ุจูุงูุงุชูู ููุท
- โ ุงูุฌููุน ูููููู ูุฑุงุกุฉ ุงูููุชุฌุงุช ูุงููุฆุงุช
- โ ููุท ุงูุฃุฏูู ููููู ุชุนุฏูู ุงูููุชุฌุงุช ูุงููุฆุงุช
- โ ุงููุณุชุฎุฏููู ูููููู ุฅุฏุงุฑุฉ ุณูุฉ ุงูุชุณูู ูุงูููุถูุฉ ุงูุฎุงุตุฉ ุจูู

---

## ๐ค ุฅุนุฏุงุฏ ุงูุฃุฏูู

ุงููุณุชุฎุฏู ุงูุฃุฏูู ูุชู ุชุนูููู ุชููุงุฆูุงู ุนูุฏ ุชุณุฌูู ูุณุชุฎุฏู ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู `aliabouali2005@gmail.com`.

**ูุชุนููู ุงูุฃุฏูู ูุฏููุงู:**
```sql
UPDATE public.users 
SET is_admin = TRUE 
WHERE id = (SELECT id FROM auth.users WHERE email = 'aliabouali2005@gmail.com');
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู

ุจุนุฏ ุชุดุบูู ุงูู migrationุ ุชุญูู ูู:

- [ ] ุฌููุน ุงูุฌุฏุงูู ุงูู 8 ุชู ุฅูุดุงุคูุง
- [ ] RLS ููุนู ุนูู ุฌููุน ุงูุฌุฏุงูู
- [ ] ุงููุฆุงุช ุงูุงูุชุฑุงุถูุฉ ุชู ุฅุฏุฑุงุฌูุง
- [ ] ุงูููุงุฑุณ (Indexes) ุชู ุฅูุดุงุคูุง
- [ ] Triggers ุชู ุฅุนุฏุงุฏูุง ูุชุญุฏูุซ `updated_at`

---

## ๐ ุงูุชูู!

ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู. ุฌููุน ุงูุฌุฏุงูู ูุญููุฉ ุจู RLSุ ูุงูุจููุฉ ุชุฏุนู ุฌููุน ููุฒุงุช ุชุทุจูู NexBuy!


# ๐ ุฏููู ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช - NexBuy

ูุฐุง ุงูุฏููู ุณูุณุงุนุฏู ูู ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุงููุฉ ูุชุทุจูู NexBuy ูู Supabase.

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### ุงูุฎุทูุฉ 1: ูุชุญ ูุญุฑุฑ SQL ูู Supabase

1. ุงุฐูุจ ุฅูู ููุญุฉ ุชุญูู ูุดุฑูุน Supabase
2. ุงุถุบุท ุนูู **SQL Editor** ูู ุงูุดุฑูุท ุงูุฌุงูุจู
3. ุงุถุบุท ุนูู **New Query**

### ุงูุฎุทูุฉ 2: ุชุดุบูู Migration

1. ุงูุณุฎ ูุญุชูู ููู `supabase_migration.sql` ุจุงููุงูู
2. ุงูุตูู ูู ูุญุฑุฑ SQL
3. ุงุถุบุท ุนูู **Run** (ุฃู ุงุถุบุท `Ctrl+Enter`)

### ุงูุฎุทูุฉ 3: ุงูุชุญูู ูู ุงูุฌุฏุงูู

1. ุงุฐูุจ ุฅูู **Table Editor** ูู ุงูุดุฑูุท ุงูุฌุงูุจู
2. ูุฌุจ ุฃู ุชุฑู ูุฐู ุงูุฌุฏุงูู:
   - โ `users` - ูุนูููุงุช ุงููุณุชุฎุฏููู
   - โ `addresses` - ุนูุงููู ุงูุดุญู
   - โ `categories` - ูุฆุงุช ุงูููุชุฌุงุช
   - โ `products` - ุงูููุชุฌุงุช
   - โ `orders` - ุงูุทูุจุงุช
   - โ `order_items` - ุนูุงุตุฑ ุงูุทูุจุงุช
   - โ `cart_items` - ุณูุฉ ุงูุชุณูู
   - โ `favorites` - ุงูููุถูุฉ

---

## ๐ ูุธุฑุฉ ุนุงูุฉ ุนูู ูุงุนุฏุฉ ุงูุจูุงูุงุช

### 1. ุฌุฏูู **users**
ูุฎุฒู ูุนูููุงุช ุงููุณุชุฎุฏู ุงูุฅุถุงููุฉ (ุงูุงุณูุ ุงููุงุชูุ ุตูุฑุฉ ุงูููู ุงูุดุฎุตูุ ุญุงูุฉ ุงูุฃุฏูู)

**ุงูุฃุนูุฏุฉ:**
- `id` - ูุนุฑู ุงููุณุชุฎุฏู (ูุฑุจุท ุจู auth.users)
- `name` - ุงูุงุณู
- `phone` - ุฑูู ุงููุงุชู
- `profile_image` - ุฑุงุจุท ุตูุฑุฉ ุงูููู ุงูุดุฎุตู
- `is_admin` - ูู ุงููุณุชุฎุฏู ุฃุฏููุ (ุงูุชุฑุงุถู: false)
- `created_at` - ุชุงุฑูุฎ ุงูุฅูุดุงุก
- `updated_at` - ุชุงุฑูุฎ ุงูุชุญุฏูุซ

---

### 2. ุฌุฏูู **addresses**
ูุฎุฒู ุนูุงููู ุงูุดุญู ูููุณุชุฎุฏููู

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู ุงููุฑูุฏ
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `title` - ุงูุนููุงู (ูุซู: "ุงูููุฒู"ุ "ุงูุนูู")
- `full_address` - ุงูุนููุงู ุงููุงูู
- `latitude` - ุฎุท ุงูุนุฑุถ
- `longitude` - ุฎุท ุงูุทูู
- `city` - ุงููุฏููุฉ
- `state` - ุงููุญุงูุธุฉ
- `zip_code` - ุงูุฑูุฒ ุงูุจุฑูุฏู
- `country` - ุงูุฏููุฉ (ุงูุชุฑุงุถู: "Egypt")
- `is_default` - ูู ูู ุงูุนููุงู ุงูุงูุชุฑุงุถูุ
- `created_at` - ุชุงุฑูุฎ ุงูุฅูุดุงุก
- `updated_at` - ุชุงุฑูุฎ ุงูุชุญุฏูุซ

---

### 3. ุฌุฏูู **categories**
ูุฎุฒู ูุฆุงุช ุงูููุชุฌุงุช

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู (ูุซู: "smartphones", "laptops")
- `name_en` - ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ
- `name_ar` - ุงูุงุณู ุจุงูุนุฑุจูุฉ
- `image_url` - ุฑุงุจุท ุงูุตูุฑุฉ
- `description` - ุงููุตู

**ุงููุฆุงุช ุงูุงูุชุฑุงุถูุฉ:**
- Smartphones / ุงูููุงุชู ุงูุฐููุฉ
- Laptops / ุฃุฌูุฒุฉ ุงูููุจููุชุฑ ุงููุญูููุฉ
- Headphones / ุณูุงุนุงุช ุงูุฑุฃุณ
- Watches / ุงูุณุงุนุงุช
- Tablets / ุงูุฃุฌูุฒุฉ ุงูููุญูุฉ
- Accessories / ุงูุฅูุณุณูุงุฑุงุช

---

### 4. ุฌุฏูู **products**
ูุฎุฒู ูุนูููุงุช ุงูููุชุฌุงุช

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `name` - ุงูุงุณู
- `description` - ุงููุตู
- `price` - ุงูุณุนุฑ
- `rating` - ุงูุชูููู (ุงูุชุฑุงุถู: 4.5)
- `image_path` - ูุณุงุฑ ุงูุตูุฑุฉ
- `category` - ุงููุฆุฉ
- `is_favorite` - ูู ููุถูุ
- `features` - ุงููููุฒุงุช (JSONB)
- `brand` - ุงูุนูุงูุฉ ุงูุชุฌุงุฑูุฉ
- `model` - ุงูููุฏูู
- `specifications` - ุงูููุงุตูุงุช (JSONB)
- `stock_quantity` - ุงููููุฉ ุงููุชููุฑุฉ
- `created_at` - ุชุงุฑูุฎ ุงูุฅูุดุงุก
- `updated_at` - ุชุงุฑูุฎ ุงูุชุญุฏูุซ

---

### 5. ุฌุฏูู **orders**
ูุฎุฒู ุทูุจุงุช ุงููุณุชุฎุฏููู

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `order_number` - ุฑูู ุงูุทูุจ (ูุซู: "NEX-2024-001")
- `total_amount` - ุงููุจูุบ ุงูุฅุฌูุงูู
- `status` - ุงูุญุงูุฉ (pending, confirmed, processing, shipped, delivered, cancelled, returned)
- `shipping_address_id` - ูุนุฑู ุนููุงู ุงูุดุญู
- `order_date` - ุชุงุฑูุฎ ุงูุทูุจ
- `delivery_date` - ุชุงุฑูุฎ ุงูุชุณููู
- `tracking_number` - ุฑูู ุงูุชุชุจุน
- `payment_method` - ุทุฑููุฉ ุงูุฏูุน
- `payment_status` - ุญุงูุฉ ุงูุฏูุน

---

### 6. ุฌุฏูู **order_items**
ูุฎุฒู ุนูุงุตุฑ ูู ุทูุจ

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `order_id` - ูุนุฑู ุงูุทูุจ
- `product_id` - ูุนุฑู ุงูููุชุฌ
- `product_name` - ุงุณู ุงูููุชุฌ (ูุณุฎุฉ ูุญููุธุฉ)
- `product_image` - ุตูุฑุฉ ุงูููุชุฌ (ูุณุฎุฉ ูุญููุธุฉ)
- `price` - ุงูุณุนุฑ (ูุณุฎุฉ ูุญููุธุฉ)
- `quantity` - ุงููููุฉ

---

### 7. ุฌุฏูู **cart_items**
ูุฎุฒู ุนูุงุตุฑ ุณูุฉ ุงูุชุณูู

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `product_id` - ูุนุฑู ุงูููุชุฌ
- `quantity` - ุงููููุฉ

---

### 8. ุฌุฏูู **favorites**
ูุฎุฒู ุงูููุชุฌุงุช ุงูููุถูุฉ ูููุณุชุฎุฏููู

**ุงูุฃุนูุฏุฉ:**
- `id` - ุงููุนุฑู
- `user_id` - ูุนุฑู ุงููุณุชุฎุฏู
- `product_id` - ูุนุฑู ุงูููุชุฌ

---

## ๐ ุงูุฃูุงู (RLS Policies)

ุฌููุน ุงูุฌุฏุงูู ูุฏููุง **Row Level Security (RLS)** ููุนู ูุน ุงูุณูุงุณุงุช ุงูุชุงููุฉ:

- โ ุงููุณุชุฎุฏููู ูููููู ูุฑุงุกุฉ/ุชุญุฏูุซ ุจูุงูุงุชูู ููุท
- โ ุงูุฌููุน ูููููู ูุฑุงุกุฉ ุงูููุชุฌุงุช ูุงููุฆุงุช
- โ ููุท ุงูุฃุฏูู ููููู ุชุนุฏูู ุงูููุชุฌุงุช ูุงููุฆุงุช
- โ ุงููุณุชุฎุฏููู ูููููู ุฅุฏุงุฑุฉ ุณูุฉ ุงูุชุณูู ูุงูููุถูุฉ ุงูุฎุงุตุฉ ุจูู

---

## ๐ค ุฅุนุฏุงุฏ ุงูุฃุฏูู

ุงููุณุชุฎุฏู ุงูุฃุฏูู ูุชู ุชุนูููู ุชููุงุฆูุงู ุนูุฏ ุชุณุฌูู ูุณุชุฎุฏู ุจุงูุจุฑูุฏ ุงูุฅููุชุฑููู `aliabouali2005@gmail.com`.

**ูุชุนููู ุงูุฃุฏูู ูุฏููุงู:**
```sql
UPDATE public.users 
SET is_admin = TRUE 
WHERE id = (SELECT id FROM auth.users WHERE email = 'aliabouali2005@gmail.com');
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู

ุจุนุฏ ุชุดุบูู ุงูู migrationุ ุชุญูู ูู:

- [ ] ุฌููุน ุงูุฌุฏุงูู ุงูู 8 ุชู ุฅูุดุงุคูุง
- [ ] RLS ููุนู ุนูู ุฌููุน ุงูุฌุฏุงูู
- [ ] ุงููุฆุงุช ุงูุงูุชุฑุงุถูุฉ ุชู ุฅุฏุฑุงุฌูุง
- [ ] ุงูููุงุฑุณ (Indexes) ุชู ุฅูุดุงุคูุง
- [ ] Triggers ุชู ุฅุนุฏุงุฏูุง ูุชุญุฏูุซ `updated_at`

---

## ๐ ุงูุชูู!

ูุงุนุฏุฉ ุงูุจูุงูุงุช ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู. ุฌููุน ุงูุฌุฏุงูู ูุญููุฉ ุจู RLSุ ูุงูุจููุฉ ุชุฏุนู ุฌููุน ููุฒุงุช ุชุทุจูู NexBuy!

